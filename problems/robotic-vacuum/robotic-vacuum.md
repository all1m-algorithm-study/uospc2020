# 로봇 청소기

## 문제

임베디드시스템설계 수업에서 라즈베리파이를 배운 정현이는 최근 라즈베리파이로 로봇 청소기를 만들고 있다.

정현이의 집은 세로의 길이가 $R$, 가로의 길이가 $C$인 직사각형 모양이고, 각 위치를 $(r, c)$의 좌표로 표현할 수 있다. 여기에서 $r$은 행의 번호, $c$는 열의 번호이다. $(1\leq r \leq R, 1\leq c \leq C)$

정현이가 만들 로봇 청소기는 $(a, b)$에서 출발하여 동서남북 중 한 방향으로 한 칸씩 이동하면서 방을 청소하게 된다. 그리고 $(a, b)$가 아닌 다른 위치 $(u, v)$에는 무선 충전 패드가 있는데, 로봇이 이 패드 위에 위치하면 충전을 위해 자동으로 동작을 멈추게 된다.

정현이는 로봇 제어를 위한 소프트웨어를 작성하기 위해, UOS(Universal Observing Script)라는 새로운 스크립트 언어를 만들었다. UOS의 인터프리터는 소스코드의 각 구문을 순차적으로 실행하며, 소스코드의 끝에 도달했다면 다시 코드의 처음으로 돌아가 다시 실행한다. 즉, 인터프리터는 주어진 소스코드를 무한히 반복하여 실행하게 되며 프로그램이 종료하는 것은 오직 로봇이 무선 충전 패드에 위치하게 될 경우 뿐이다.

아래는 UOS의 문법을 간략하게 표현한 것이고, 그 아래는 문법과 관련된 부가설명을 나타낸 것이다.

```
<program> := "" | <statement> <program>
<statement> := <command> | <if-block> | <while-block> | <until-block>
<command> := "L" | "R" | "G"
<if-block> := "i" <condition> "{" <program> "}"
<while-block> := "w" <condition> "{" <program> "}"
<until-block> := "u" <condition> "{" <program> "}"
<condition> := "E" | "W" | "S" | "N"
```

1. 소스코드에는 공백 문자가 사용되지 않는다.
2. 전체 프로그램 소스는 하나의 `<program>`이다.
3. `<program>`은 빈 문자열이거나, `<statement>`와 `<program>`이 연결된 문자열이다.
4. `<statement>`는 `<command>` 이거나, `<if-block>` 이거나, `<until-block>`이다.
5. `<command>`는 "L", "R", "G" 중 하나이다.
   * "L"이 실행되면 로봇이 왼쪽으로 돌아 원래 보던 방향의 왼쪽을 본다.
   * "R"이 실행되면 로봇이 오른쪽으로 돌아 원래 보던 방향의 오른쪽을 본다.
   * "G"가 실행되면 로봇이 현재 보는 방향으로 한 칸 이동한다. 그 방향에 벽이나 장애물이 있어서 이동할 수 없다면 이 명령은 무시된다.
6. `<if-block>`은 "i", `<condition>`, "{", `<program>`, "}"가 연결된 문자열이다.
   * `<if-block>`은 우리가 익히 알고 있는 조건문처럼 실행되는데, `<condition>`이 참이라면, 중괄호 내부의 `<program>`이 실행된다. `<condition>`이 거짓이라면, 중괄호를 건너뛰고 다음 구문을 실행한다.
7. `<while-block>`은 "w", `<condition>`, "{", `<program>`, "}"가 연결된 문자열이다.
   * `<while-block>`은 `<condition>`이 참일 동안 중괄호 안의 `<program>`을 반복하여 실행하는 구문이다.
8. `<until-block>`은 "u", `<condition>`, "{", `<program>`, "}"가 연결된 문자열이다.
   * `<until-block>`은 `<condition>`이 거짓일 동안 중괄호 안의 `<program>`을 반복하여 실행하는 구문이다.
9. `<condition>`은 "E", "W", "S", "N" 중 하나이다.
   * "E", "W", "S", "N" 각각은 동, 서, 남, 북을 의미하는데, 로봇이 바라보는 방향을 북쪽이라고 했을 때, 각 방향에 벽이나 장애물이 존재하는지를 참, 거짓 타입으로 반환한다.

위와 같은 문법을 따르면, `GG`라는 구문*(현재 보는 방향으로 두 칸 이동)*이나, `iE{LG}`와 같은 조건문*(동쪽에 벽이나 장애물이 있다면 왼쪽으로 돌아 한 칸 이동)*이 가능하다. 

`<if-block>`, `<while-block>`, `<until-block>`은 중괄호 안에 `<program>`을 받으므로, 블록 안에 또 다른 블록이 있을 수 있음을 유의하자. 즉 `uN{GiR{L}}`와 같은 복합적인 구문도 가능하다.

정현이는 이렇게 새로운 스크립트 언어를 만들고 난 뒤 본격적으로 개발에 착수하였는데, 로봇 청소기는 주기적으로 충전을 해주어야 하기에, 로봇이 어느정도 동작하다가 무선 충전 패드에 도달할 수 있도록 소스코드를 작성하기로 하였다. 여기에서 정현이는 큰 의문에 봉착하였는데, 로봇이 가장 처음 $(a, b)$에서 북쪽을 바라본 상태에서 시작하고, 무선 충전 패드가 $(u, v)$에 있다면, 로봇의 프로그램은 영원히 종료되지 않고 반복될까, 아니면 언젠가 무선 충전 패드에 도달해서 프로그램이 종료될까?

세로의 길이가 $R$, 가로의 길이가 $C$인 방에 있는 장애물들의 위치가 주어지고, 로봇 청소기의 시작 위치, 무선 충전 패드의 위치, 무한 반복하여 실행될 UOS 소스 코드가 주어졌을 때 프로그램이 언젠가 종료하게 될지, 아니면 영원히 종료되지 않을지 판단하는 알고리즘을 작성하시오.

## 입력

첫째 줄에 집의 세로 길이와 가로 길이를 나타내는 $R$, $C$가 공백으로 구분되어 주어진다. $(1\leq R\leq 100, 1\leq C\leq 100)$

둘째 줄부터 $R$줄에 걸쳐 집의 상태가 문자열로 주어진다. 각 줄은 $C$개의 문자로 이루어져있으며, 'X'은 장애물이 있는 칸, '.'은 장애물이 없는 칸을 의미한다. 또한 로봇 청소기가 출발하는 위치는 'S',  무선 충전 패드가 있는 위치는 'D'이다. 'S'와 'D'는 항상 유일하게 주어진다.

마지막 줄에는 실행할 UOS 소스 코드가 주어지며, 코드의 길이는 500자를 넘지 않는다.

## 출력

UOS 인터프리터가 코드를 무한히 실행하더라도 프로그램이 영원히 무선 충전 패드에 도달하지 못하여 종료되지 않는다면 "LOOP FOREVER"를 출력한다.

그렇지 않고 유한히 이동한 뒤에는 프로그램이 종료됨이 보장된다면, "TERMINATED"를 출력한다.

## 예제 입력 1

```
8 3
...
.X.
...
...
...
.S.
.D.
...
uN{G}LL
```

## 예제 출력 1

```
TERMINATED
```

## 예제 입력 2

```
3 3
...
.D.
..S
GGL
```

## 예제 출력 2

```
LOOP FOREVER
```